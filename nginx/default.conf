# nginx/default.conf

# Bloco 1: Servidor HTTP (permanece ativo para o desafio do Certbot)
server {
    listen 80;
    server_name forms.newnet.com.br pesquisa.newnet.com.br;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }
}

# Bloco 2: Servidor HTTPS para o Formulário (TEMPORARIAMENTE "QUEBRADO")
server {
    # A linha abaixo também deve ser comentada para desativar este bloco por completo
    # listen 443 ssl;
    server_name forms.newnet.com.br;

    # Todas estas linhas precisam estar comentadas:
    # ssl_certificate /etc/letsencrypt/live/forms.newnet.com.br/fullchain.pem;
    # ssl_certificate_key /etc/letsencrypt/live/forms.newnet.com.br/privkey.pem;
    # include /etc/letsencrypt/options-ssl-nginx.conf; # <--- LINHA DO ERRO ATUAL
    # ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;   # <--- ESTA DARIA O PRÓXIMO ERRO

    # O conteúdo interno não importa agora, pois o bloco está desativado
    location /api {
        proxy_pass http://api:8000;
        proxy_set_header Host $host;
    }
    location / {
        proxy_pass http://form:3000;
        proxy_set_header Host $host;
    }
}

# Bloco 3: Servidor HTTPS para o Dashboard (TEMPORARIAMENTE "QUEBRADO")
server {
    # A linha abaixo também deve ser comentada
    # listen 443 ssl;
    server_name pesquisa.newnet.com.br;

    # Todas estas linhas precisam estar comentadas:
    # ssl_certificate /etc/letsencrypt/live/pesquisa.newnet.com.br/fullchain.pem;
    # ssl_certificate_key /etc/letsencrypt/live/pesquisa.newnet.com.br/privkey.pem;
    # include /etc/letsencrypt/options-ssl-nginx.conf;
    # ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    location /api {
        proxy_pass http://api:8000;
        proxy_set_header Host $host;
    }
    location / {
        proxy_pass http://admin:80;
        proxy_set_header Host $host;
    }
}